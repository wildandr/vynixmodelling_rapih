2025-10-03 14:07:23,688 - INFO - Original dataframe shape: (3816, 14)
2025-10-03 14:07:23,690 - INFO - Total rows in df without NaN or null values: 3783
2025-10-03 14:07:23,867 - INFO - Kolom dengan data lengkap (>= 70.0%): 57
2025-10-03 14:07:23,867 - INFO - Kolom dengan data tidak lengkap (kurang dari 70.0%): 481
2025-10-03 14:07:23,873 - INFO - 
Filtered DataFrame shape: (57, 57)
2025-10-03 14:07:23,874 - INFO - Data completeness setelah filtering: 100.00%
2025-10-03 14:07:23,921 - INFO - 
Enhanced DataFrame shape: (57, 151)
2025-10-03 14:07:23,921 - INFO - Jumlah fitur asli: 57
2025-10-03 14:07:23,921 - INFO - Jumlah fitur baru: 94
2025-10-03 14:07:23,922 - INFO - Total fitur: 151
2025-10-03 14:07:23,922 - INFO - 
Statistik Enhanced DataFrame:
2025-10-03 14:07:23,922 - INFO - Data completeness: 98.95%
2025-10-03 14:07:23,924 - INFO - Kolom dengan data tidak lengkap di Enhanced DataFrame: 39
2025-10-03 14:07:23,942 - INFO - 
Enhanced DataFrame saved to: datasets/fundamental/TSLA_enhanced_features.csv
2025-10-03 14:07:23,943 - INFO - DataFrame setelah filter q > 2012-Q1: (53, 151)
2025-10-03 14:07:23,943 - INFO - Data completeness: 100.00%
2025-10-03 14:07:23,943 - INFO - Processing technical and fundamental data...
2025-10-03 14:07:23,943 - INFO - Starting complete preprocessing pipeline with quarter shift mapping
2025-10-03 14:07:23,943 - INFO - Preparing technical data
2025-10-03 14:07:23,949 - INFO - Technical data prepared: 3783 rows, 17 columns
2025-10-03 14:07:23,949 - INFO - Preparing fundamental data
2025-10-03 14:07:23,950 - INFO - Fundamental data prepared: 53 quarters, 151 features
2025-10-03 14:07:23,950 - INFO - Converting quarterly data to daily format with quarter shift mapping
2025-10-03 14:07:25,392 - INFO - Daily conversion completed: 4839 days, 151 features
2025-10-03 14:07:25,393 - INFO - Data availability with quarter shift mapping: 98.12%
2025-10-03 14:07:25,393 - INFO - Combining technical and fundamental data
2025-10-03 14:07:25,427 - INFO - Data combination completed: 3330 rows, 168 columns
2025-10-03 14:07:25,427 - INFO - Date range: 2012-04-02 to 2025-06-30
2025-10-03 14:07:25,427 - INFO - Filtering data from 2012-Q2 to 2025-Q2
2025-10-03 14:07:25,443 - INFO - Filtering completed: 3330 rows remaining
2025-10-03 14:07:25,444 - INFO - Saving processed data to: datasets/processed/main_processed_data.csv
2025-10-03 14:07:25,840 - INFO - Data saved successfully: 3330 rows, 168 columns
2025-10-03 14:07:25,841 - INFO - Complete preprocessing pipeline finished successfully
2025-10-03 14:07:25,841 - INFO - Data processing completed: (3330, 168)
2025-10-03 14:07:25,841 - INFO - Processed data saved to: datasets/processed/main_processed_data.csv
2025-10-03 14:07:25,841 - INFO - 
Final processed data shape: (3330, 168)
2025-10-03 14:07:25,842 - INFO - Date range: 2012-04-02 00:00:00 to 2025-06-30 00:00:00
2025-10-03 14:07:25,842 - INFO - Technical columns: 8
2025-10-03 14:07:25,842 - INFO - Fundamental columns: 157
2025-10-03 14:07:25,842 - INFO - 
Preprocessing completed successfully!
2025-10-03 14:07:25,843 - INFO - Data completeness: 98.30%
2025-10-03 14:07:25,843 - INFO - 
=== Applying Triple Barrier Method ===
2025-10-03 14:07:25,843 - INFO - Starting Triple Barrier Method labeling...
2025-10-03 14:07:26,253 - INFO - 
=== Generating Triple Barrier Visualizations ===
2025-10-03 14:07:26,253 - INFO - Generating Triple Barrier visualizations...
2025-10-03 14:07:26,547 - INFO - Visualizations generated: 2 files
2025-10-03 14:07:26,547 - INFO - label_1_html: logs/visualization/visualisasi_20251003_140726_label_positif.html
2025-10-03 14:07:26,547 - INFO - label_-1_html: logs/visualization/visualisasi_20251003_140726_label_negatif.html
2025-10-03 14:07:26,547 - INFO - 
=== Triple Barrier Implementation Complete ===
2025-10-03 14:07:26,548 - INFO - Labels generated: 3314 samples
2025-10-03 14:07:26,548 - INFO - Results saved to: logs/triple_barrier/triple_barrier_results.csv
2025-10-03 14:07:26,548 - INFO - 
=== Merging Triple Barrier Labels with Features ===
2025-10-03 14:07:26,548 - INFO - Merging triple_barrier_df with filtered_df based on decision_date...
2025-10-03 14:07:26,559 - INFO - Triple Barrier data shape: (3314, 11)
2025-10-03 14:07:26,559 - INFO - Filtered data shape: (3330, 168)
2025-10-03 14:07:26,560 - INFO - Merged data shape: (3314, 178)
2025-10-03 14:07:26,561 - INFO - Successfully merged: 3251 complete rows
2025-10-03 14:07:27,088 - INFO - Merged labeled data saved to: datasets/processed/merged_labeled_data.csv
2025-10-03 14:07:27,088 - INFO - 
=== Final Summary ===
2025-10-03 14:07:27,088 - INFO - Original processed data shape: (3330, 168)
2025-10-03 14:07:27,088 - INFO - Triple Barrier labels: 3314 samples
2025-10-03 14:07:27,088 - INFO - Merged labeled data shape: (3314, 178)
2025-10-03 14:07:27,089 - INFO - Date range: 2012-04-02 00:00:00 to 2025-06-30 00:00:00
2025-10-03 14:07:27,089 - INFO - Date range: 2012-04-02 00:00:00 to 2025-06-05 00:00:00
2025-10-03 14:07:27,089 - INFO - Technical + Fundamental features: 168 columns
2025-10-03 14:07:27,089 - INFO - Total features in merged data: 178 columns
2025-10-03 14:07:27,089 - INFO - Triple Barrier parameters used: {'volatility_window': 20, 'upper_barrier_multiplier': 1.0, 'lower_barrier_multiplier': 1.0, 'time_barrier_days': 15, 'verbose': True}
2025-10-03 14:07:27,089 - INFO - 
All preprocessing, labeling, and merging completed successfully!
2025-10-03 14:07:27,090 - INFO - Dropped columns: ['decision_date', 'entry_date', 'end_date', 'end_price', 'return', 'barrier_touched', 'value_at_barrier_touched', 'time_converted', 'datetime', 'time']
2025-10-03 14:07:27,091 - INFO - Training DataFrame shape after dropping columns: (3314, 168)
2025-10-03 14:07:27,091 - INFO - Training DataFrame columns: ['entry_price', 'upper_barrier', 'lower_barrier', 'label', 'open', 'high', 'low', 'close', 'Volume', 'Histogram', 'MACD', 'Signal', 'K', 'D', 'Turnover (Cr)', '10 MA Turnover', 'Turnover / 10MA (X)', 'AccountsPayableCurrent', 'AccountsReceivableNetCurrent', 'AccumulatedDepreciationDepletionAndAmortizationPropertyPlantAndEquipment', 'AccumulatedOtherComprehensiveIncomeLossNetOfTax', 'AdditionalPaidInCapitalCommonStock', 'AllocatedShareBasedCompensationExpense', 'Assets', 'AssetsCurrent', 'CashAndCashEquivalentsAtCarryingValue', 'CommonStockValue', 'ComprehensiveIncomeNetOfTax', 'CostOfRevenue', 'EmployeeRelatedLiabilitiesCurrent', 'GrossProfit', 'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest', 'IncomeTaxExpenseBenefit', 'IncreaseDecreaseInAccountsPayableAndAccruedLiabilities', 'IncreaseDecreaseInAccountsReceivable', 'IncreaseDecreaseInOtherNoncurrentLiabilities', 'IncreaseDecreaseInPrepaidDeferredExpenseAndOtherAssets', 'InterestCostsCapitalized', 'InterestExpense', 'InventoryNet', 'InventoryWriteDown', 'InvestmentIncomeInterest', 'Liabilities', 'LiabilitiesAndStockholdersEquity', 'LiabilitiesCurrent', 'NetCashProvidedByUsedInFinancingActivities', 'NetCashProvidedByUsedInInvestingActivities', 'NetCashProvidedByUsedInOperatingActivities', 'NetIncomeLoss', 'NoncashOrPartNoncashAcquisitionValueOfAssetsAcquired1', 'NoncurrentAssets', 'OperatingExpenses', 'OperatingIncomeLoss', 'OtherAssetsNoncurrent', 'OtherComprehensiveIncomeLossForeignCurrencyTransactionAndTranslationAdjustmentNetOfTax', 'OtherLiabilitiesNoncurrent', 'OtherNonoperatingIncomeExpense', 'PaymentsToAcquirePropertyPlantAndEquipment', 'PrepaidExpenseAndOtherAssetsCurrent', 'ProceedsFromIssuanceOfSharesUnderIncentiveAndShareBasedCompensationPlansIncludingStockOptions', 'ProductWarrantyAccrualPreexistingIncreaseDecrease', 'PropertyPlantAndEquipmentGross', 'PropertyPlantAndEquipmentNet', 'ResearchAndDevelopmentExpense', 'RetainedEarningsAccumulatedDeficit', 'Revenues', 'SellingGeneralAndAdministrativeExpense', 'ShareBasedCompensation', 'StandardProductWarrantyAccrual', 'StandardProductWarrantyAccrualPayments', 'StandardProductWarrantyAccrualWarrantiesIssued', 'StockholdersEquity', 'TaxesPayableCurrent', 'UnrecognizedTaxBenefits', 'current_ratio', 'quick_ratio', 'cash_ratio', 'working_capital', 'accounts_receivable_turnover', 'days_sales_outstanding', 'inventory_turnover', 'days_inventory_outstanding', 'accounts_payable_turnover', 'days_payable_outstanding', 'cash_conversion_cycle', 'gross_profit_margin', 'operating_profit_margin', 'net_profit_margin', 'return_on_assets', 'return_on_equity', 'debt_to_equity_ratio', 'debt_to_assets_ratio', 'interest_coverage_ratio', 'operating_expense_ratio', 'rd_to_revenue_ratio', 'sga_to_revenue_ratio', 'fixed_asset_turnover', 'total_asset_turnover', 'capital_expenditure_ratio', 'compensation_efficiency', 'warranty_reserve_ratio', 'depreciation_rate', 'operating_cash_flow_to_net_income_ratio', 'effective_tax_rate', 'revenue_growth_rate', 'net_income_growth_rate', 'asset_growth_rate', 'accrual_ratio', 'cash_flow_to_revenue_ratio', 'return_on_invested_capital', 'cash_return_on_capital_invested', 'fixed_assets_to_long_term_debt_ratio', 'non_current_asset_turnover', 'quarterly_gross_profit_stability', 'revenue_to_expense_growth_differential', 'quarterly_cash_flow_quality', 'dividend_payout_ratio', 'stock_based_compensation_to_operating_expense_ratio', 'financial_leverage_index', 'asset_coverage_ratio', 'quarterly_margin_expansion', 'asset_utilization_ratio', 'capacity_utilization_proxy', 'altman_z_score', 'dupont_analysis_roe', 'economic_value_added', 'rd_efficiency_ratio', 'innovation_investment_ratio', 'revenue_momentum', 'earnings_momentum', 'quarterly_earnings_quality_index', 'non_operating_items_ratio', 'revenues_qoq_growth', 'revenues_yoy_growth', 'revenues_ttm', 'revenues_acceleration', 'revenues_seasonal_index', 'revenues_moving_avg', 'revenues_run_rate', 'revenues_volatility', 'revenues_seasonal_dependency', 'net_income_qoq_growth', 'net_income_yoy_growth', 'net_income_ttm', 'net_income_acceleration', 'net_income_seasonal_index', 'net_income_moving_avg', 'net_income_run_rate', 'net_income_volatility', 'assets_qoq_growth', 'assets_yoy_growth', 'assets_ttm', 'operating_income_qoq_growth', 'operating_income_yoy_growth', 'operating_income_ttm', 'cash_qoq_growth', 'cash_yoy_growth', 'equity_qoq_growth', 'equity_yoy_growth', 'liabilities_qoq_growth', 'liabilities_yoy_growth', 'quarterly_operating_leverage', 'quarterly_cash_burn_rate', 'revenues_ytd', 'netincomeloss_ytd', 'operatingincomeloss_ytd', 'long_term_revenue_cagr', 'operating_margin_trend']
2025-10-03 14:07:27,091 - INFO - 
=== Splitting Data into Train, Validation, and Test Sets (Time-based) ===
2025-10-03 14:07:27,091 - INFO - Splitting data into train, validation, and test sets using time-based approach...
2025-10-03 14:07:27,105 - INFO - Test data period: 2024-07-01 00:00:00 to 2025-06-05 00:00:00
2025-10-03 14:07:27,105 - INFO - Test data shape: (234, 178)
2025-10-03 14:07:27,107 - INFO - Train+Val data period: 2012-04-02 00:00:00 to 2024-06-28 00:00:00
2025-10-03 14:07:27,107 - INFO - Train+Val data shape: (3080, 178)
2025-10-03 14:07:27,123 - INFO - X_train shape: (2464, 167), y_train shape: (2464,)
2025-10-03 14:07:27,123 - INFO - X_test shape: (234, 167), y_test shape: (234,)
2025-10-03 14:07:27,123 - INFO - X_val shape: (616, 167), y_val shape: (616,)
2025-10-03 14:07:27,555 - INFO - Train, test, and validation data saved to datasets/training_data
2025-10-03 14:07:27,556 - INFO - 8. HYPERPARAMETER TUNING
2025-10-03 14:07:27,556 - INFO - ================================================================================
2025-10-03 14:07:27,752 - INFO - 
Combined HMM, XGBoost, and Barrier Parameters Tuning with Optuna
2025-10-03 14:07:27,753 - INFO - --------------------------------------------------
2025-10-03 14:07:27,753 - INFO - Combined HMM, XGBoost, and LSTM Parameters Tuning with Optuna
2025-10-03 14:07:27,753 - INFO - --------------------------------------------------
2025-10-03 14:07:27,753 - INFO - TensorFlow available - using XGB-HMM-LSTM hybrid optimization
2025-10-03 14:07:27,753 - INFO - Starting combined_xgb_hmm_lstm_barrier_parameters optimization with Optuna...
2025-10-03 14:07:28,071 - INFO - Study 'combined_xgb_hmm_lstm_barrier_parameters' created/loaded with storage: logs/optuna_studies/combined_xgb_hmm_lstm_barrier_parameters.db
2025-10-03 14:07:28,761 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 14:07:28,761 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 14:07:29,332 - WARNING - Model is not converging.  Current: -4485448.027733002 is not greater than -4485448.027732983. Delta is -1.862645149230957e-08
2025-10-03 14:07:29,346 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 14:34:57,171 - INFO - Maximum iterations (860) reached
2025-10-03 14:34:57,178 - INFO - XGB-HMM training completed
2025-10-03 14:34:57,553 - INFO - Combined Parameters Optimization - Trial 21: New best score 0.7890
2025-10-03 14:35:00,604 - INFO - Adjusting n_states from 3 to 2 to match number of unique classes
2025-10-03 14:35:00,604 - INFO - Starting XGB-HMM training with 2 states for 2 classes...
2025-10-03 14:35:00,604 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 14:35:00,798 - WARNING - Model is not converging.  Current: -4632811.305760366 is not greater than -4632811.305760025. Delta is -3.4086406230926514e-07
2025-10-03 14:35:00,817 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 14:50:19,699 - INFO - Maximum iterations (1000) reached
2025-10-03 14:50:19,709 - INFO - XGB-HMM training completed
2025-10-03 14:50:21,182 - INFO - Adjusting n_states from 4 to 3 to match number of unique classes
2025-10-03 14:50:21,183 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 14:50:21,183 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 14:50:21,468 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 15:08:55,116 - INFO - Maximum iterations (650) reached
2025-10-03 15:08:55,123 - INFO - XGB-HMM training completed
2025-10-03 15:08:55,300 - INFO - Combined Parameters Optimization - Trial 23: New best score 0.8490
2025-10-03 15:08:56,136 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 15:08:56,136 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 15:08:56,266 - WARNING - Model is not converging.  Current: -4485450.657476889 is not greater than -4485450.6574768005. Delta is -8.847564458847046e-08
2025-10-03 15:08:56,277 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 15:32:19,216 - INFO - Maximum iterations (920) reached
2025-10-03 15:32:19,221 - INFO - XGB-HMM training completed
2025-10-03 15:32:20,401 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 15:32:20,401 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 15:32:20,630 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 15:55:24,833 - INFO - Maximum iterations (880) reached
2025-10-03 15:55:24,838 - INFO - XGB-HMM training completed
2025-10-03 15:55:25,892 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 15:55:25,892 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 15:55:26,047 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 16:17:02,449 - INFO - Maximum iterations (700) reached
2025-10-03 16:17:02,456 - INFO - XGB-HMM training completed
2025-10-03 16:17:02,801 - INFO - Combined Parameters Optimization - Trial 26: New best score 0.8815
2025-10-03 16:17:04,837 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 16:17:04,837 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 16:17:05,137 - WARNING - Model is not converging.  Current: -4485450.065816166 is not greater than -4485450.065816134. Delta is -3.166496753692627e-08
2025-10-03 16:17:05,150 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 16:37:08,668 - INFO - Maximum iterations (640) reached
2025-10-03 16:37:08,677 - INFO - XGB-HMM training completed
2025-10-03 16:37:09,796 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 16:37:09,796 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 16:37:09,965 - WARNING - Model is not converging.  Current: -4485447.819198996 is not greater than -4485447.8191989055. Delta is -9.033828973770142e-08
2025-10-03 16:37:09,975 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 16:56:59,710 - INFO - Maximum iterations (720) reached
2025-10-03 16:56:59,722 - INFO - XGB-HMM training completed
2025-10-03 16:57:01,039 - INFO - Adjusting n_states from 4 to 3 to match number of unique classes
2025-10-03 16:57:01,040 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 16:57:01,040 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 16:57:01,200 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 17:21:26,677 - INFO - Maximum iterations (830) reached
2025-10-03 17:21:26,682 - INFO - XGB-HMM training completed
2025-10-03 17:21:28,033 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 17:21:28,033 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 17:21:28,256 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 17:34:23,584 - INFO - Maximum iterations (470) reached
2025-10-03 17:34:23,587 - INFO - XGB-HMM training completed
2025-10-03 17:34:23,859 - INFO - 
Combined hyperparameter tuning completed in 12416.10 seconds
2025-10-03 17:34:23,859 - INFO - Best combined validation accuracy: 0.8815
2025-10-03 17:34:23,859 - INFO - Best trial number: 26
2025-10-03 17:34:23,859 - INFO - 
Best HMM Parameters:
2025-10-03 17:34:23,859 - INFO -   n_states: 3
2025-10-03 17:34:23,860 - INFO -   max_iter: 700
2025-10-03 17:34:23,860 - INFO -   tol: 8.900876447967033e-06
2025-10-03 17:34:23,860 - INFO - 
Best XGBoost Parameters:
2025-10-03 17:34:23,860 - INFO -   n_estimators: 100
2025-10-03 17:34:23,860 - INFO -   max_depth: 8
2025-10-03 17:34:23,860 - INFO -   learning_rate: 0.06397033011773137
2025-10-03 17:34:23,860 - INFO -   subsample: 0.9
2025-10-03 17:34:23,860 - INFO -   colsample_bytree: 0.9
2025-10-03 17:34:23,861 - INFO -   reg_alpha: 8.1
2025-10-03 17:34:23,861 - INFO -   reg_lambda: 1.9
2025-10-03 17:34:23,861 - INFO -   min_child_weight: 7
2025-10-03 17:34:23,861 - INFO -   gamma: 4.4
2025-10-03 17:34:23,861 - INFO - 
Best LSTM Parameters:
2025-10-03 17:34:23,861 - INFO -   sequence_length: 400
2025-10-03 17:34:23,861 - INFO -   lstm_units: 432
2025-10-03 17:34:23,861 - INFO -   dropout_rate: 0.32
2025-10-03 17:34:23,861 - INFO -   learning_rate: 0.0005655332644067792
2025-10-03 17:34:23,861 - INFO - 
Best Ensemble Weights: XGB=0.20, HMM=0.28, LSTM=0.52
2025-10-03 17:34:23,862 - INFO - 
Best Barrier Parameters:
2025-10-03 17:34:23,862 - INFO -   volatility_window: 50
2025-10-03 17:34:23,862 - INFO -   upper_barrier_multiplier: 2.4000000000000004
2025-10-03 17:34:23,862 - INFO -   lower_barrier_multiplier: 2.4000000000000004
2025-10-03 17:34:23,862 - INFO -   time_barrier_days: 35
2025-10-03 17:34:23,883 - INFO - Optimization summary saved to: logs/xgb_results/combined_optimization_summary.pkl
2025-10-03 17:34:23,883 - INFO - 
Using best parameters from combined tuning for final model training...
2025-10-03 17:34:23,883 - INFO - Applying triple barrier labeling with optimized parameters...
2025-10-03 17:34:24,630 - INFO - Updated merged data with optimized barrier parameters: (3294, 178)
2025-10-03 17:34:24,631 - INFO - 
9. Training XGB-HMM Hybrid Model
2025-10-03 17:34:24,631 - INFO - --------------------------------------------------
2025-10-03 17:34:24,631 - INFO - Using existing triple barrier data for XGB-HMM training...
2025-10-03 17:34:24,631 - INFO - Triple barrier data already available: 3314 samples
2025-10-03 17:34:24,631 - INFO - Proceeding directly to XGB-HMM training with existing merged data...
2025-10-03 17:34:24,635 - INFO - Final dataset shape: (3294, 178)
2025-10-03 17:34:24,635 - INFO - Label distribution:
2025-10-03 17:34:24,635 - INFO - label
-1    1397
 0      17
 1    1880
Name: count, dtype: int64
2025-10-03 17:34:24,639 - INFO - Final test data period: 2024-07-01 00:00:00 to 2025-05-07 00:00:00
2025-10-03 17:34:24,639 - INFO - Final test data shape: (214, 178)
2025-10-03 17:34:24,645 - INFO - Final train+val data period: 2012-04-02 00:00:00 to 2024-06-28 00:00:00
2025-10-03 17:34:24,646 - INFO - Final train+val data shape: (3080, 178)
2025-10-03 17:34:24,669 - INFO - 
Final data splits:
2025-10-03 17:34:24,669 - INFO - Training set: 2464 samples
2025-10-03 17:34:24,669 - INFO - Validation set: 616 samples
2025-10-03 17:34:24,669 - INFO - Test set: 214 samples
2025-10-03 17:34:24,670 - INFO - 
Final label mapping: {np.int64(-1): 0, np.int64(0): 1, np.int64(1): 2}
2025-10-03 17:34:24,670 - INFO - Number of classes: 3
2025-10-03 17:34:24,671 - INFO - 
=== Applying Feature Selection ===
2025-10-03 17:34:24,671 - INFO - Initializing feature selection process...
2025-10-03 17:34:24,671 - INFO - Original number of features: 167
2025-10-03 17:34:24,671 - INFO - Applying ensemble feature selection...
2025-10-03 17:34:24,671 - INFO - Performing ensemble feature selection...
2025-10-03 17:34:24,671 - INFO - Performing univariate feature selection with k=83 features...
2025-10-03 17:34:24,703 - INFO - Univariate selection completed. Selected 83 features.
2025-10-03 17:34:24,703 - INFO - Performing mutual information feature selection with k=83 features...
2025-10-03 17:34:25,443 - INFO - Mutual information selection completed. Selected 83 features.
2025-10-03 17:34:25,443 - INFO - Performing RFE selection with n_features=83...
2025-10-03 17:34:44,942 - INFO - RFE selection completed. Selected 83 features.
2025-10-03 17:34:44,948 - INFO - Performing feature importance selection with n_features=83...
2025-10-03 17:34:46,168 - INFO - Feature importance selection completed. Selected 83 features.
2025-10-03 17:34:46,169 - INFO - Ensemble selection completed. Selected 112 features with 2+ votes.
2025-10-03 17:34:46,169 - INFO - Selected 112 features out of 167
2025-10-03 17:34:46,169 - INFO - Feature reduction: 32.93%
2025-10-03 17:34:46,169 - INFO - 
Feature Selection Summary:
2025-10-03 17:34:46,169 - INFO - Applying feature selection to training, validation, and test sets...
2025-10-03 17:34:46,170 - INFO - Selected feature names (top 10): ['entry_price', 'upper_barrier', 'lower_barrier', 'open', 'high', 'low', 'close', 'Histogram', 'MACD', 'Signal']
2025-10-03 17:34:46,170 - INFO - ... and 102 more features
2025-10-03 17:34:46,173 - INFO - Feature selection summary saved to: logs/xgb_results/feature_selection_summary.pkl
2025-10-03 17:34:46,173 - INFO - 
=== Training XGB-HMM-LSTM Triple Hybrid Model with Selected Features ===
2025-10-03 17:34:46,173 - INFO - Initializing XGB-HMM-LSTM model with optimal parameters and selected features...
2025-10-03 17:34:46,173 - INFO - XGB-HMM-LSTM Model initialized with optimized parameters
2025-10-03 17:34:46,173 - INFO -   n_states: 3
2025-10-03 17:34:46,173 - INFO -   max_iter: 700
2025-10-03 17:34:46,173 - INFO -   tol: 8.900876447967033e-06
2025-10-03 17:34:46,173 - INFO -   sequence_length: 400
2025-10-03 17:34:46,173 - INFO -   lstm_units: 432
2025-10-03 17:34:46,173 - INFO -   ensemble_weights: [0.2, 0.28, 0.52]
2025-10-03 17:34:46,173 - INFO -   TensorFlow available: True
2025-10-03 17:34:46,173 - INFO - Starting XGB-HMM-LSTM training with EM algorithm...
2025-10-03 17:34:46,173 - INFO - Starting XGB-HMM training with 3 states for 3 classes...
2025-10-03 17:34:46,174 - INFO - Initializing GMM-HMM for state estimation...
2025-10-03 17:34:46,266 - INFO - Training initial XGBoost model with GMM-derived states...
2025-10-03 17:51:02,514 - INFO - Maximum iterations (700) reached
2025-10-03 17:51:02,518 - INFO - XGB-HMM training completed
2025-10-03 17:51:02,519 - INFO - XGB-HMM-LSTM training completed in 976.35 seconds
2025-10-03 17:51:02,520 - WARNING - LSTM model not available, using XGB-HMM only
2025-10-03 17:51:02,520 - INFO - 
=== XGB-HMM-LSTM Model Detailed Evaluation ===
2025-10-03 17:51:02,906 - INFO - XGB-HMM Evaluation Metrics:
2025-10-03 17:51:02,906 - INFO -   Log Likelihood: -1701.0828
2025-10-03 17:51:02,906 - INFO -   Perplexity: 1.9945
2025-10-03 17:51:02,906 - INFO -   State Sequence Accuracy: 0.9761
2025-10-03 17:51:02,906 - INFO -   Emission Accuracy: 0.9988
2025-10-03 17:51:02,906 - INFO -   Avg Log Likelihood per Sample: -0.6904
2025-10-03 17:51:02,906 - INFO - 
Training Set XGB-HMM-LSTM Evaluation:
2025-10-03 17:51:02,906 - INFO -   log_likelihood: -1701.0828
2025-10-03 17:51:02,906 - INFO -   perplexity: 1.9945
2025-10-03 17:51:02,906 - INFO -   state_sequence_accuracy: 0.9761
2025-10-03 17:51:02,906 - INFO -   emission_accuracy: 0.9988
2025-10-03 17:51:02,906 - INFO -   avg_log_likelihood_per_sample: -0.6904
2025-10-03 17:51:03,016 - INFO - XGB-HMM Evaluation Metrics:
2025-10-03 17:51:03,016 - INFO -   Log Likelihood: -413.2482
2025-10-03 17:51:03,016 - INFO -   Perplexity: 1.9559
2025-10-03 17:51:03,016 - INFO -   State Sequence Accuracy: 0.8977
2025-10-03 17:51:03,016 - INFO -   Emission Accuracy: 0.9010
2025-10-03 17:51:03,016 - INFO -   Avg Log Likelihood per Sample: -0.6709
2025-10-03 17:51:03,016 - INFO - 
Validation Set XGB-HMM-LSTM Evaluation:
2025-10-03 17:51:03,016 - INFO -   log_likelihood: -413.2482
2025-10-03 17:51:03,016 - INFO -   perplexity: 1.9559
2025-10-03 17:51:03,016 - INFO -   state_sequence_accuracy: 0.8977
2025-10-03 17:51:03,016 - INFO -   emission_accuracy: 0.9010
2025-10-03 17:51:03,016 - INFO -   avg_log_likelihood_per_sample: -0.6709
2025-10-03 17:51:03,061 - INFO - XGB-HMM Evaluation Metrics:
2025-10-03 17:51:03,061 - INFO -   Log Likelihood: -181.5016
2025-10-03 17:51:03,061 - INFO -   Perplexity: 2.3353
2025-10-03 17:51:03,061 - INFO -   State Sequence Accuracy: 0.5654
2025-10-03 17:51:03,061 - INFO -   Emission Accuracy: 0.5841
2025-10-03 17:51:03,061 - INFO -   Avg Log Likelihood per Sample: -0.8481
2025-10-03 17:51:03,061 - INFO - 
Test Set XGB-HMM-LSTM Evaluation:
2025-10-03 17:51:03,061 - INFO -   log_likelihood: -181.5016
2025-10-03 17:51:03,061 - INFO -   perplexity: 2.3353
2025-10-03 17:51:03,061 - INFO -   state_sequence_accuracy: 0.5654
2025-10-03 17:51:03,062 - INFO -   emission_accuracy: 0.5841
2025-10-03 17:51:03,062 - INFO -   avg_log_likelihood_per_sample: -0.8481
2025-10-03 17:51:03,062 - INFO - 
=== State Transition Analysis ===
2025-10-03 17:51:03,065 - INFO - State Transition Analysis:
2025-10-03 17:51:03,067 - INFO -   State Distribution: [0.6728972 0.        0.3271028]
2025-10-03 17:51:03,067 - INFO -   Most Frequent State: 0
2025-10-03 17:51:03,067 - INFO -   Least Frequent State: 1
2025-10-03 17:51:03,067 - INFO - 
Learned Transition Matrix:
2025-10-03 17:51:03,067 - INFO - [[3.73254752e-01 0.00000000e+00 6.26745248e-01]
 [1.00000000e+00 0.00000000e+00 2.41411485e-14]
 [4.16796628e-01 0.00000000e+00 5.83203372e-01]]
2025-10-03 17:51:03,069 - INFO - 
Empirical Transition Matrix:
2025-10-03 17:51:03,070 - INFO - [[0.9020979 0.        0.0979021]
 [0.        0.        0.       ]
 [0.2       0.        0.8      ]]
2025-10-03 17:51:03,070 - INFO - 
Evaluating XGB-HMM-LSTM model on all datasets...
2025-10-03 17:51:03,252 - WARNING - ROC AUC calculation skipped due to class mismatch. Test classes: 2, Proba shape: (214, 3)
2025-10-03 17:51:03,252 - INFO - 
============================================================
2025-10-03 17:51:03,253 - INFO - XGB-HMM-LSTM HYBRID MODEL PERFORMANCE
2025-10-03 17:51:03,253 - INFO - ============================================================
2025-10-03 17:51:03,253 - INFO - 
Training Set Performance:
2025-10-03 17:51:03,253 - INFO - Accuracy: 0.9761
2025-10-03 17:51:03,253 - INFO - Precision: 0.9704
2025-10-03 17:51:03,253 - INFO - Recall: 0.9761
2025-10-03 17:51:03,253 - INFO - F1-Score: 0.9729
2025-10-03 17:51:03,253 - INFO - ROC AUC: 0.8300
2025-10-03 17:51:03,253 - INFO - 
Validation Set Performance:
2025-10-03 17:51:03,253 - INFO - Accuracy: 0.8977
2025-10-03 17:51:03,253 - INFO - Precision: 0.8982
2025-10-03 17:51:03,253 - INFO - Recall: 0.8977
2025-10-03 17:51:03,253 - INFO - F1-Score: 0.8959
2025-10-03 17:51:03,253 - INFO - ROC AUC: 0.8003
2025-10-03 17:51:03,253 - INFO - 
Test Set Performance:
2025-10-03 17:51:03,253 - INFO - Accuracy: 0.5654
2025-10-03 17:51:03,253 - INFO - Precision: 0.6000
2025-10-03 17:51:03,253 - INFO - Recall: 0.5654
2025-10-03 17:51:03,253 - INFO - F1-Score: 0.5532
2025-10-03 17:51:03,253 - INFO - ROC AUC: 0.5654
2025-10-03 17:51:03,253 - INFO - 
Test Set Confusion Matrix:
2025-10-03 17:51:03,257 - INFO - [[74 23]
 [70 47]]
2025-10-03 17:51:03,257 - INFO - 
Test Set Classification Report:
2025-10-03 17:51:03,257 - INFO - Classes in test data: [np.int64(0), np.int64(2)]
2025-10-03 17:51:03,257 - INFO - Classes predicted by model: [np.int64(0), np.int64(2)]
2025-10-03 17:51:03,257 - INFO - All classes for classification report: [np.int64(0), np.int64(2)]
2025-10-03 17:51:03,261 - INFO -               precision    recall  f1-score   support

          -1       0.51      0.76      0.61        97
           1       0.67      0.40      0.50       117

    accuracy                           0.57       214
   macro avg       0.59      0.58      0.56       214
weighted avg       0.60      0.57      0.55       214

2025-10-03 17:51:03,261 - INFO - 
============================================================
2025-10-03 17:51:03,261 - INFO - PERFORMANCE COMPARISON
2025-10-03 17:51:03,261 - INFO - ============================================================
2025-10-03 17:51:03,265 - INFO -       Dataset  Accuracy  Precision  Recall  F1-Score  ROC AUC
0    Training    0.9761     0.9704  0.9761    0.9729   0.8300
1  Validation    0.8977     0.8982  0.8977    0.8959   0.8003
2        Test    0.5654     0.6000  0.5654    0.5532   0.5654
2025-10-03 17:51:03,293 - INFO - 
Final performance comparison saved to: logs/xgb_results/final_performance_comparison.csv
2025-10-03 17:51:03,308 - INFO - XGB-HMM-LSTM model saved to: logs/xgb_models/xgb_hmm_lstm_model.pkl
2025-10-03 17:51:03,315 - INFO - Final test predictions saved to: logs/xgb_results/final_test_predictions.csv
2025-10-03 17:51:03,315 - INFO - 
============================================================
2025-10-03 17:51:03,315 - INFO - XGB-HMM-LSTM HYPERPARAMETER SUMMARY
2025-10-03 17:51:03,315 - INFO - ============================================================
2025-10-03 17:51:03,315 - INFO - 
XGB-HMM-LSTM Model Parameters:
2025-10-03 17:51:03,315 - INFO -   n_states: 3
2025-10-03 17:51:03,315 - INFO -   max_iter: 700
2025-10-03 17:51:03,315 - INFO -   tolerance: 8.900876447967033e-06
2025-10-03 17:51:03,315 - INFO -   random_state: 42
2025-10-03 17:51:03,315 - INFO - 
XGB-HMM-LSTM Training Summary:
2025-10-03 17:51:03,315 - INFO -   Training time: 976.35 seconds
2025-10-03 17:51:03,315 - INFO -   Convergence achieved: False
2025-10-03 17:51:03,315 - INFO -   Final log-likelihood: N/A
2025-10-03 17:51:03,315 - INFO - 
Hybrid XGB-HMM vs Original XGBoost Performance:
2025-10-03 17:51:03,315 - INFO - Original XGBoost Test Accuracy: ~0.45 (from previous runs)
2025-10-03 17:51:03,315 - INFO - Hybrid XGB-HMM Test Accuracy: 0.5654
2025-10-03 17:51:03,315 - INFO - Performance Improvement: 25.65%
2025-10-03 17:51:03,315 - INFO - 
Hybrid XGB-HMM Model Generalization:
2025-10-03 17:51:03,316 - INFO - Training Accuracy: 0.9761
2025-10-03 17:51:03,316 - INFO - Validation Accuracy: 0.8977
2025-10-03 17:51:03,316 - INFO - Test Accuracy: 0.5654
2025-10-03 17:51:03,316 - INFO - Train-Val Gap: 0.0783
2025-10-03 17:51:03,316 - INFO - Train-Test Gap: 0.4106
2025-10-03 17:51:03,316 - INFO - 
=== Feature Selection Impact Analysis ===
2025-10-03 17:51:03,316 - INFO - Original features: 167
2025-10-03 17:51:03,316 - INFO - Selected features: 112
2025-10-03 17:51:03,316 - INFO - Feature reduction: 32.93%
2025-10-03 17:51:03,316 - INFO - Model performance maintained with 67.07% of original features
2025-10-03 17:51:03,316 - INFO - 
================================================================================
2025-10-03 17:51:03,316 - INFO - XGB-HMM-LSTM HYBRID MODEL WITH FEATURE SELECTION COMPLETED SUCCESSFULLY!
2025-10-03 17:51:03,316 - INFO - ================================================================================
